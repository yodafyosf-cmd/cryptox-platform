from flask import Flask, request, redirect

app = Flask(__name__)

balance = 0
pending = []

@app.route("/")
def home():
    return f"""
    <h1>CryptoX Demo</h1>
    <h2>Balance: ${balance}</h2>

    <form action="/deposit" method="post">
        <input type="number" name="amount" placeholder="Deposit amount" required>
        <button type="submit">Request Deposit</button>
    </form>

    <br><br>
    <a href="/admin">Admin Panel</a>
    """

@app.route("/deposit", methods=["POST"])
def deposit():
    amount = request.form.get("amount")
    pending.append(amount)
    return redirect("/")

@app.route("/admin")
def admin():
    html = "<h1>Admin Panel</h1>"
    for i, amt in enumerate(pending):
        html += f"""
        <p>Deposit: ${amt}
        <a href='/approve/{i}'>Approve</a></p>
        """
    html += "<br><a href='/'>Back</a>"
    return html

@app.route("/approve/<int:index>")
def approve(index):
    global balance
    balance += int(pending[index])
    pending.pop(index)
    return redirect("/admin")

app.run(host="0.0.0.0", port=3000)
